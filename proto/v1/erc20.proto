syntax = "proto3";

package erc20.types.v1;

message BalanceChanges {
  repeated BalanceChange balance_changes = 1;
}

enum BalanceChangeType {
  TYPE_UNKNOWN = 0; // cannot determine balance change
  TYPE_1 = 1; // easy case where storage change is in the same call as the Transfer call
  TYPE_2 = 2; // storage change is in a different call than the Transfer call
}

message BalanceChange {
  string contract = 1; // 0xmytokencontract
  string owner = 2;  // 0xmyaddress
  string old_balance = 3; // 0x1234
  string new_balance = 4; // 0x1234

  string transaction = 5; // 0xmytransaction
  string storage_key = 6; // 0xmykey
  uint32 call_index = 7; // 0xmycallindex

  string transfer_value = 8; // 0x1234

  BalanceChangeType change_type = 9;
}

message BalanceChangeStats {
  uint64 type0_count = 1;
  uint64 type1_count = 2;
  uint64 type2_count = 3;

  uint64 total_count = 42;
  string valid_rate = 43;
  uint64 block_number = 99;
}